<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SPI-PACK: description</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SPI-PACK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">description </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr/>
 <h2>layout: default </h2>
<h1>Inverse Kolmogorov operator</h1>
<p>For more information on the Kolmogorov operator see ../Kolmogorov-eigendecomposition/description.md "the Kolmogorov eigendecomposition example".</p>
<p>Let $$ be a probability density function and let $[ {x}^{(i)} ]_{i=1}^{n}$ be samples from $$. Given constant $c$ and function f, define the Kolmogorov operator</p>
<p>$$ {equation} {L}_{, c} f =  f + c  f  { }{} {equation} $$</p>
<p>Note the special cases:</p><ul>
<li>$c=0$: The Laplacian operator ${L}_{,0} f =  f$</li>
<li>$c=1$: The weighted Laplacian operator ${L}_{,1} f =  f +  f  { }{} = ^{-1}   (  f)$</li>
</ul>
<p>The goal of this example is to find a function $h$ such that</p>
<p>$$ {equation} {array}{ccc} {L}_{, c} h = f &amp; {and} &amp; {E}_{}[h]=0. {array} {equation} $$</p>
<p>Setting the expected value of $h$ to zero is necessary because the constant function is in the null space of ${L}_{}$.</p>
<p>Given the discrete Kolmogorov operator ${L}_{, c}$, the discrete version of the problem is</p>
<p>$$ {equation} {array}{ccc} {L}_{, c} {h} = {f} &amp; {and} &amp; {i=1}^{n} h^{(i)} = 0. {array} {equation} $$</p>
<p>Nationally, ${h}$ and ${f}$ are vectors such that the $i^{th}$ components $h^{(i)}$ and $f^{(i)}$ are the function evaluations $h^{(i)} = h({x}^{(i)})$ and $f^{(i)} = f({x}^{(i)})$ at each sample. Recall from ../Kolmogorov-eigendecomposition/description.md "the Kolmogorov eigendecomposition example" the similarity transformation and eigendecomposition</p>
<p>$$ {equation} {array}{ccc} {L}_{, c} = {S}^{-1} {{L}}_{, c} {S} &amp; {and} &amp; {{L}}_{, c} {{Q}} = {{Q}} {} {array} {equation} $$</p>
<p>where ${S}$ is a diagonal matrix.</p>
<p>Define coefficients</p>
<p>$$ {equation} {array}{ccc} {{h}} = {{Q}}^T {S} {h} &amp; {and} &amp; {{f}} = {{Q}}^T {S} {f}, {array} {equation} $$</p>
<p>allowing us to express ${h}$ and ${f}$ as an expansion using the eigenvectors ${{Q}}$ of ${{L}}_{, c}$ as a basis. Substituting these coefficients and the eigendecomposition into the discretize problem derives</p>
<p>$$ {equation} {} {{h}} = {{f}}. {equation} $$</p>
<p>Given evaluations of the right hand side at each sample, we compute the coefficients ${{f}}$ and then solutions to the problem are defined by the coefficients ${{h}} = {}^{-} {{f}}$, where ${}^{-}$ denotes the pseudo-inverse of the diagonal matrix ${}$. We recover the solution at each sample by expanding using the eigenvectors ${h} = {S}^{-1} {{Q}} {{h}}$ and shifting the solution so that ${i=1}^{n} h^{(i)} = 0$.</p>
<p>Given the coefficients and the eigendecomposition we must also compute the unweighted gradient ${{x}} h$. Let $v$ be an additional scalar function. The product rule for the weighted Laplace operator is</p>
<p>$$ {equation} {} (v h) = v {} h + h {} v + 2 {{x}} h  {{x}} v. {equation} $$</p>
<p>Let $(, q_j)$ be eigenvalue/eigenfunction pairs such that ${} q_j =  q_j$. The product rule implies that</p>
<p>$$ {eqnarray} {{x}} q_j  {{x}} q_k &amp;=&amp; {1}{2} ( {} (q_j q_k) - q_j {} q_k - q_k {} q_j ) \ &amp;=&amp; {1}{2} ( {} (q_j q_k) - ( + ) q_j q_k ) {eqnarray} $$</p>
<p>Define the coefficient</p>
<p>$$ {equation} C_{ljk} =  q_l, q_j q_k {} = {{R}^{2}} q_l^{} q_j q_k  \, d{x}  ({q}_l^{-1})^T ({q}_j * {q}_k), {equation} $$</p>
<p>where $*$ is the component-wise product operator between vectors, ${q}_{j}$ is the $j^{th}$ eigenvector of the discrete Laplace operator ${L}_{, c}$ (i.e., the $j^{th}$ column of ${Q} = {S}^{-1} {{Q}}$), and $({Q}_l^{-1})^T$ is the $l^{th}$ row of ${Q}^{-1} = {{Q}}^T {S}$. This implies that</p>
<p>$$ {equation} Q_j Q_k = {i=1}^{} C_{ljk} Q_l. {equation} $$</p>
<p>This derives</p>
<p>$$ {equation} {{x}} q_j  {{x}} q_k = {l=1}^{} {C_{ljk}}{2} ( -  - ) q_l. {equation} $$</p>
<p>Finally, choose the function $v({x}) = x_s$ that picks the $s^{th}$ coordinate index. Let ${x}_s$ be the vector such that each entry $V_s^{(i)}$ is the $s^{th}$ coordinate of the $i^{th}$ sample. Define the coefficients ${{x}}_s = {{Q}}^T {S} {x}_s$. Using the product rule, we write the $s^{th}$ component of the unweighted gradient ${{x}} h$ as</p>
<p>$$ {eqnarray} {{x}} h  {{x}} v &amp;=&amp; {j,k=1}^{} {h}^{(j)} {x}_{s}^{(k)} {{x}} q_j  {{V}} q_k \ &amp;=&amp; {l,j,k=1}^{} {h}^{(j)} {x}_{s}^{(k)} {C_{ljk}}{2} ( -  - ) q_l. {eqnarray} $$</p>
<p>Replacing the eigenfunction $q_l$ with the eigenvector ${Q}_l$ and truncating after $n_{eig}$ eigenvalue/eigenvector pairs approximates the $s^{th}$ component of ${{x}} h$ at each sample.</p>
<p>The figure below shows the solution $h$ and its gradient ${{x}} h$ for the problem with right hand side function $f({x}) = x_0$.</p>
<p>&lt;figure&gt; &lt;figcaption&gt;The solution $h$ and its gradient ${{x}} h$ for the problem with right hand side function $f({x}) = x_0$. Here, we use $n=10^3$ samples from a standard Gaussian distribution ${N}({0}, {I})$.&lt;/figcaption&gt; &lt;embed src="figures/Kolmogorov_inverse.pdf" width="500" height="375" type="application/pdf"&gt; &lt;/figure&gt; </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
